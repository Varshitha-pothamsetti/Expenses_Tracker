<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Expense Tracker üí∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { font-family:'Poppins',sans-serif; background:#f4f7fa; }
    .navbar { background: rgba(0,0,0,0.8) !important; }
    .navbar-nav .nav-link { margin:0 12px; font-weight:500; transition:color 0.3s; }
    .navbar-nav .nav-link:hover { color:#ffc107 !important; }
    .hero { 
      background:url("https://images.unsplash.com/photo-1556742044-3c52d6e88c62?auto=format&fit=crop&w=1500&q=80") no-repeat center/cover; 
      color:white; text-align:center; padding:120px 20px; position:relative; 
    }
    .hero::after { content:""; position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); }
    .hero .content { position:relative; z-index:1; }
    .hero h1 { font-size:3rem; margin-bottom:10px; }
    .hero p { font-size:1.2rem; }
    .card { border-radius:15px; transition: transform 0.3s, box-shadow 0.3s; }
    .card:hover { transform:translateY(-5px); box-shadow:0 10px 25px rgba(0,0,0,0.2); }
    .icon { font-size:2rem; margin-bottom:10px; }
    section { display:none; animation:fadeIn 0.5s ease-in-out; }
    section.active { display:block; }
    @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
    .table { background:white; border-radius:10px; overflow:hidden; }
    footer { margin-top:40px; padding:15px; text-align:center; background:#343a40; color:white; }
    .btn { border-radius:8px; transition: transform 0.3s; }
    .btn:hover { transform: scale(1.05); }
    .report-card { text-align:center; padding:20px; border-radius:15px; background:white; box-shadow:0 5px 15px rgba(0,0,0,0.1); transition:0.3s; }
    .report-card:hover { transform: translateY(-5px); box-shadow:0 10px 25px rgba(0,0,0,0.2); }
    .duplicate { background-color: #fff3cd !important; }

    /* ADDED: Highlight active nav item (only added CSS) */
    .navbar-nav .nav-link.active {
      color: #ffc107 !important;
      font-weight: 700;
      border-bottom: 2px solid #ffc107;
    }
  </style>
</head>
<body onload="initApp()">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#"><i class="fa-solid fa-wallet"></i> Expense Tracker</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('dashboard')"><i class="fa-solid fa-chart-line"></i> Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('transactions')"><i class="fa-solid fa-list"></i> Transactions</a></li>
        <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('add')"><i class="fa-solid fa-plus-circle"></i> Add</a></li>
        <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('profile')"><i class="fa-solid fa-user"></i> Profile</a></li>
        <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('about')"><i class="fa-solid fa-circle-info"></i> About</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- Hero -->
<header class="hero">
  <div class="content">
    <h1>üí∞ Smart Expense Tracker</h1>
    <p>Manage your income & expenses with ease and insights.</p>
  </div>
</header>

<!-- Dashboard -->
<section id="dashboard" class="container mt-5 active">
  <h2 class="mb-4"><i class="fa-solid fa-chart-line"></i> Dashboard</h2>
  <div class="row g-4 mb-4 text-center">
    <div class="col-md-3">
      <div class="card p-3 shadow-sm bg-light">
        <i class="fa-solid fa-money-bill-wave text-success icon"></i>
        <h5>Total Income</h5>
        <h3 class="text-success" id="totalIncome">‚Çπ0.00</h3>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 shadow-sm bg-light">
        <i class="fa-solid fa-credit-card text-danger icon"></i>
        <h5>Total Expenses</h5>
        <h3 class="text-danger" id="totalExpense">‚Çπ0.00</h3>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 shadow-sm bg-light">
        <i class="fa-solid fa-scale-balanced text-primary icon"></i>
        <h5>Balance</h5>
        <h3 id="balance">‚Çπ0.00</h3>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 shadow-sm bg-light">
        <i class="fa-solid fa-arrow-trend-up text-warning icon"></i>
        <h5>Transactions</h5>
        <h3 id="totalTransactions">0</h3>
      </div>
    </div>
  </div>

  <!-- Charts -->
  <div class="row g-4">
    <div class="col-md-4">
      <div class="card p-3 shadow-sm bg-white">
        <h5 class="mb-3"><i class="fa-solid fa-chart-pie"></i> Income vs Expense</h5>
        <canvas id="incomeExpenseChart"></canvas>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card p-3 shadow-sm bg-white">
        <h5 class="mb-3"><i class="fa-solid fa-chart-bar"></i> Monthly Overview</h5>
        <canvas id="monthlyChart"></canvas>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card p-3 shadow-sm bg-white">
        <h5 class="mb-3"><i class="fa-solid fa-chart-line"></i> Transactions by Type</h5>
        <canvas id="typeChart"></canvas>
      </div>
    </div>
  </div>
</section>

<!-- Transactions -->
<section id="transactions" class="container mt-5">
  <h2 class="mb-4"><i class="fa-solid fa-list"></i> All Transactions (Duplicates Highlighted)</h2>
  <div class="table-responsive shadow-sm">
    <table class="table table-bordered table-striped">
      <thead class="table-dark">
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th>Type</th>
          <th>Amount</th>
        </tr>
      </thead>
      <tbody id="transactionsTable"></tbody>
    </table>
  </div>
</section>

<!-- Add Transaction -->
<section id="add" class="container mt-5">
  <h2 class="mb-4"><i class="fa-solid fa-plus-circle"></i> Add Transaction</h2>
  <form onsubmit="handleSubmit(event)" class="shadow p-4 bg-white rounded">
    <div class="mb-3">
      <label class="form-label">Type</label>
      <select id="type" class="form-select">
        <option value="Income">Income</option>
        <option value="Expense">Expense</option>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">Description</label>
      <input type="text" id="description" class="form-control" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Amount (‚Çπ)</label>
      <input type="number" id="amount" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-primary w-100"><i class="fa-solid fa-check"></i> Add</button>
  </form>
</section>

<!-- Profile -->
<section id="profile" class="container mt-5">
  <h2 class="mb-4"><i class="fa-solid fa-user"></i> Profile</h2>
  <div class="card p-4 shadow-sm text-center">
    <img src="https://avatars.githubusercontent.com/u/9919?s=200&v=4" class="rounded-circle mb-3" width="120">
    <h4>John Doe</h4>
    <p>Email: johndoe@example.com</p>
    <p>Total Transactions: <span id="profileTransactions">0</span></p>
  </div>
</section>

<!-- About -->
<section id="about" class="container mt-5">
  <h2 class="mb-4"><i class="fa-solid fa-circle-info"></i> About This Project</h2>
  <p>This Expense Tracker now shows <b>duplicates</b> separately in all charts and tables.</p>
  <ul>
    <li>Track daily income and expenses.</li>
    <li>View summary dashboard with charts (duplicates shown).</li>
    <li>Data stored in your browser (localStorage).</li>
  </ul>
  <p><b>Built with:</b> HTML, CSS, Bootstrap, JavaScript, Chart.js</p>
</section>

<footer>üíº Expense Tracker ¬© 2025 | Built with ‚ù§Ô∏è by You</footer>

<script>
  // --- LocalStorage ---
  function getTransactions(){ return JSON.parse(localStorage.getItem("transactions"))||[]; }
  function saveTransactions(transactions){ localStorage.setItem("transactions",JSON.stringify(transactions)); }

  // --- Add Transaction ---
  function addTransaction(type, desc, amount){
    let transactions=getTransactions();
    transactions.push({id:Date.now(),type,description:desc,amount:parseFloat(amount),date:new Date().toLocaleDateString()});
    saveTransactions(transactions);
  }

  // --- Render Transactions Table ---
  function renderTransactionsTable(){
    let transactions=getTransactions();
    let tbody=document.getElementById("transactionsTable");
    tbody.innerHTML="";
    let seen = {};
    transactions.forEach(t=>{
      let key = t.type + "|" + t.description + "|" + t.amount + "|" + t.date;
      let isDuplicate = seen[key] ? true : false;
      seen[key] = true;
      tbody.innerHTML+=`<tr class="${isDuplicate?'duplicate':''}">
        <td>${t.date}</td>
        <td>${t.description}</td>
        <td>${t.type}</td>
        <td class="${t.type==='Income'?'text-success':'text-danger'}">${t.type==='Income'?'+':'-'}‚Çπ${t.amount.toFixed(2)}</td>
      </tr>`;
    });
    document.getElementById("totalTransactions").textContent=transactions.length;
    document.getElementById("profileTransactions").textContent=transactions.length;
  }

  // --- Render Dashboard ---
  function renderDashboard(){
    let transactions=getTransactions();
    let income = transactions.filter(t=>t.type==='Income').reduce((sum,t)=>sum+t.amount,0);
    let expense = transactions.filter(t=>t.type==='Expense').reduce((sum,t)=>sum+t.amount,0);
    let balance = income - expense;
    document.getElementById("totalIncome").textContent="‚Çπ"+income.toFixed(2);
    document.getElementById("totalExpense").textContent="‚Çπ"+expense.toFixed(2);
    document.getElementById("balance").textContent="‚Çπ"+balance.toFixed(2);

    // --- Income vs Expense Doughnut ---
    let doughnutData = transactions.map(t => t.amount);
    let doughnutLabels = transactions.map(t => t.description);
    let doughnutColors = transactions.map(t => t.type==='Income'?'#28a745':'#dc3545');
    let ctx1 = document.getElementById("incomeExpenseChart").getContext("2d");
    if(window.incomeExpenseChart) window.incomeExpenseChart.destroy();
    window.incomeExpenseChart = new Chart(ctx1, {
      type:'doughnut',
      data:{ labels:doughnutLabels, datasets:[{data:doughnutData, backgroundColor:doughnutColors}] }
    });

    // --- Monthly Bar Chart ---
    let monthlyLabels = transactions.map(t => t.date);
    let ctx2 = document.getElementById("monthlyChart").getContext("2d");
    if(window.monthlyChart) window.monthlyChart.destroy();
    window.monthlyChart = new Chart(ctx2,{
      type:'bar',
      data:{
        labels: monthlyLabels,
        datasets:[
          {label:'Income', data:transactions.map(t=>t.type==='Income'?t.amount:0), backgroundColor:'#28a745'},
          {label:'Expense', data:transactions.map(t=>t.type==='Expense'?t.amount:0), backgroundColor:'#dc3545'}
        ]
      },
      options:{responsive:true, plugins:{legend:{position:'top'}}}
    });

    // --- Transactions by Type Pie ---
    let typeCounts = {Income:0, Expense:0};
    transactions.forEach(t=>typeCounts[t.type]++);
    let ctx3 = document.getElementById("typeChart").getContext("2d");
    if(window.typeChart) window.typeChart.destroy();
    window.typeChart = new Chart(ctx3,{
      type:'pie',
      data:{
        labels:['Income','Expense'],
        datasets:[{data:[typeCounts.Income,typeCounts.Expense], backgroundColor:['#28a745','#dc3545'] }]
      },
      options:{responsive:true}
    });
  }

  // --- Form Submit ---
  function handleSubmit(e){
    e.preventDefault();
    const type=document.getElementById("type").value;
    const desc=document.getElementById("description").value;
    const amount=document.getElementById("amount").value;
    addTransaction(type,desc,amount);
    alert("Transaction Added!");
    document.getElementById("description").value="";
    document.getElementById("amount").value="";
    renderTransactionsTable();
    renderDashboard();
    showSection('transactions');
  }

  // --- Section Switch ---
  function showSection(id){
    document.querySelectorAll("section").forEach(sec=>sec.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    if(id==='transactions') renderTransactionsTable();
    if(id==='dashboard') renderDashboard();
    window.scrollTo(0,0);
  }

  // --- Initialize App with Duplicate Transactions ---
  function initApp() {
    if (!localStorage.getItem("transactions") || getTransactions().length === 0) {
      const sampleTransactions = [
        { type: "Income", description: "Salary", amount: 50000, date: "2025-09-01" },
        { type: "Income", description: "Salary", amount: 50000, date: "2025-09-01" }, // duplicate
        { type: "Expense", description: "Groceries", amount: 4000, date: "2025-09-03" },
        { type: "Expense", description: "Groceries", amount: 4000, date: "2025-09-03" }, // duplicate
        { type: "Income", description: "Freelance", amount: 12000, date: "2025-09-05" },
        { type: "Expense", description: "Electricity Bill", amount: 2000, date: "2025-09-07" },
        { type: "Expense", description: "Electricity Bill", amount: 2000, date: "2025-09-07" }, // duplicate
        { type: "Income", description: "Bonus", amount: 8000, date: "2025-09-10" },
        { type: "Expense", description: "Shopping", amount: 5000, date: "2025-09-12" },
        { type: "Expense", description: "Shopping", amount: 5000, date: "2025-09-12" }, // duplicate
      ];
      saveTransactions(sampleTransactions);
    }
    renderDashboard();
    renderTransactionsTable();
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- >>> ADDED: small script to enable header highlight + fill empty cards with duplicates (no other code changed) -->
<script>
(function(){
  // find nav links and toggle active by matching the onclick target id
  function setActiveNavById(id){
    document.querySelectorAll('.navbar-nav .nav-link').forEach(link=>{
      const onclick = link.getAttribute('onclick') || '';
      const m = onclick.match(/showSection\s*\(\s*['"]([^'"]+)['"]\s*\)/);
      if(m && m[1] === id){
        link.classList.add('active');
      } else {
        link.classList.remove('active');
      }
    });
  }

  // get duplicate transactions (returns array of transaction objects that are duplicates)
  function getDuplicateTransactions(){
    const tx = getTransactions();
    const seen = {};
    const duplicates = [];
    tx.forEach(t=>{
      const key = t.type + '|' + t.description + '|' + t.amount + '|' + t.date;
      if(seen[key]) duplicates.push(t);
      seen[key] = true;
    });
    return duplicates;
  }

  // fill empty .card elements (but skip chart cards that contain <canvas>)
  function fillEmptyCards(){
    const duplicates = getDuplicateTransactions();
    let fallbackIndex = 1;
    document.querySelectorAll('.card').forEach((card)=>{
      // skip if card has a canvas (chart) or meaningful text
      if(card.querySelector('canvas')) return;
      // check if there's visible text already (headings, icons, values)
      if(card.innerText.trim().length === 0){
        // prefer real duplicate data if available
        if(duplicates.length > 0){
          let html = '';
          // show up to two duplicate entries
          for(let i=0;i<2 && i<duplicates.length;i++){
            const d = duplicates[i];
            html += `<p>${d.description} (${d.type}) - ‚Çπ${d.amount.toFixed(2)}</p>`;
          }
          // if duplicates < 2, add fallback lines
          for(let j=duplicates.length;j<2;j++){
            html += `<p>Duplicate Value ${fallbackIndex}</p>`;
            fallbackIndex++;
          }
          card.innerHTML = html;
        } else {
          // no duplicates found, fallback simple duplicate text
          card.innerHTML = `<p>Duplicate Value ${fallbackIndex}</p><p>Duplicate Value ${fallbackIndex}</p>`;
          fallbackIndex++;
        }
      }
    });
  }

  // Monkey-patch showSection to also update nav highlight + fill cards
  if(typeof window.showSection === 'function'){
    const original = window.showSection;
    window.showSection = function(id){
      original.call(this, id);
      try { setActiveNavById(id); } catch(e){}
      try { fillEmptyCards(); } catch(e){}
    };
  }

  // run once on load to set initial active nav and fill empty cards
  window.addEventListener('load', function(){
    // find currently active section (there is a dashboard active by default in your markup)
    const activeSection = document.querySelector('section.active');
    const id = activeSection ? activeSection.id : 'dashboard';
    setActiveNavById(id);
    fillEmptyCards();
  });
})();
</script>

</body>
</html>
